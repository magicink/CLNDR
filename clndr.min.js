!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("luxon"),require("moment"),require("jquery")):"function"==typeof define&&define.amd?define(["exports","luxon","moment","jquery"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).clndr={},t.luxon,t.moment,t.jQuery)}(this,function(t,e,n,s){"use strict";class a{constructor(t,e){this.dt=t,this.owner=e}value(){return this.dt}toISO(){return this.dt.toISO()||this.dt.toISODate()}format(t){if("dd"===t){return(e.Info.weekdays("short",{locale:this.owner.getLocale()})[this.dt.weekday-1]||this.dt.toFormat("ccc")).slice(0,2)}const n=this.owner.normalizeTokens(t);return this.dt.setLocale(this.owner.getLocale()).toFormat(n)}startOf(t){if("week"===t){const t=this.owner.firstDayOfWeek(),e=0===t?7:t,n=(this.dt.weekday-e+7)%7,s=this.dt.minus({days:n}).startOf("day");return new a(s,this.owner)}return new a(this.dt.startOf(t),this.owner)}endOf(t){if("week"===t){const t=this.startOf("week");return new a(t.value().plus({days:6}).endOf("day"),this.owner)}return new a(this.dt.endOf(t),this.owner)}plus(t){return new a(this.dt.plus(t),this.owner)}minus(t){return new a(this.dt.minus(t),this.owner)}weekday(){return this.dt.weekday}day(){return this.dt.day}daysInMonth(){return this.dt.daysInMonth}isBefore(t){return this.dt.toMillis()<t.value().toMillis()}isAfter(t){return this.dt.toMillis()>t.value().toMillis()}hasSame(t,e){return this.dt.hasSame(t.value(),e)}}class i{constructor(t="en",e){this.locale=t,this.zone=e}now(){const t=e.DateTime.now().set({}).setLocale(this.locale),n=this.zone?t.setZone(this.zone):t;return new a(n,this)}fromISO(t){const n=e.DateTime.fromISO(t,{locale:this.locale,zone:this.zone});return new a(n,this)}fromFormat(t,n){const s=this.normalizeTokens(n),i=e.DateTime.fromFormat(t,s,{locale:this.locale,zone:this.zone});return new a(i,this)}fromNative(t){const n=(e.DateTime.isDateTime(t)?t:e.DateTime.fromJSDate(t,{locale:this.locale,zone:this.zone})).setLocale(this.locale),s=this.zone?n.setZone(this.zone):n;return new a(s,this)}withLocale(t){return new i(t,this.zone)}getLocale(){return this.locale}firstDayOfWeek(){const t=(this.locale||"en").toLowerCase();return t.startsWith("fr")||t.startsWith("de")||t.startsWith("en-gb")?1:0}setWeekday(t,e){const n=t.value(),s=new a(n,this).startOf("week").value().plus({days:(e%7+7)%7});return new a(s,this)}weekdayLabels(t){const n=e.Info.weekdays(t,{locale:this.locale}),s=this.firstDayOfWeek(),a=0===s?6:s-1;return[...n.slice(a),...n.slice(0,a)]}normalizeTokens(t){let e=t;return e=e.replace(/YYYY/g,"yyyy").replace(/YY/g,"yy"),e=e.replace(/dddd/g,"cccc").replace(/ddd(?!d)/g,"ccc"),e=e.replace(/MMMM/g,"LLLL").replace(/MMM(?!M)/g,"LLL"),e=e.replace(/MM(?!M)/g,"LL").replace(/M(?!M)/g,"L"),e=e.replace(/DD(?!D)/g,"dd").replace(/D(?!D)/g,"d"),e}}function r(t,e){return new i(t,e)}class o{constructor(t){this.m=t}value(){return this.m}toISO(){return this.m.toISOString()}format(t){return this.m.format(t)}startOf(t){return new o(this.m.clone().startOf(t))}endOf(t){return new o(this.m.clone().endOf(t))}plus(t){const e=this.m.clone();return t.milliseconds&&e.add(t.milliseconds,"milliseconds"),t.seconds&&e.add(t.seconds,"seconds"),t.minutes&&e.add(t.minutes,"minutes"),t.hours&&e.add(t.hours,"hours"),t.days&&e.add(t.days,"days"),t.weeks&&e.add(t.weeks,"weeks"),t.months&&e.add(t.months,"months"),t.years&&e.add(t.years,"years"),new o(e)}minus(t){const e=this.m.clone();return t.milliseconds&&e.subtract(t.milliseconds,"milliseconds"),t.seconds&&e.subtract(t.seconds,"seconds"),t.minutes&&e.subtract(t.minutes,"minutes"),t.hours&&e.subtract(t.hours,"hours"),t.days&&e.subtract(t.days,"days"),t.weeks&&e.subtract(t.weeks,"weeks"),t.months&&e.subtract(t.months,"months"),t.years&&e.subtract(t.years,"years"),new o(e)}weekday(){return this.m.isoWeekday()}day(){return this.m.date()}daysInMonth(){return this.m.daysInMonth()}isBefore(t){return this.m.isBefore(t.value())}isAfter(t){return this.m.isAfter(t.value())}hasSame(t,e){return this.m.isSame(t.value(),e)}}class l{constructor(t=n.locale()){this.locale=t}now(){return new o(n())}fromISO(t){return new o(n(t))}fromFormat(t,e){return new o(n(t,e))}fromNative(t){return new o(n(t))}withLocale(t){return new l(t)}getLocale(){return this.locale}firstDayOfWeek(){return n.localeData(this.locale).firstDayOfWeek()}setWeekday(t,e){const n=(e%7+7)%7,s=t.value().clone().weekday(n);return new o(s)}weekdayLabels(t){const e=n.localeData(this.locale);return"narrow"===t?e.weekdaysMin():"short"===t?e.weekdaysShort():e.weekdays()}normalizeTokens(t){return t}}function h(t){return new l(t)}function d(t,e){return null==e?t.now():"string"==typeof e?t.fromISO(e):t.fromNative(e)}function u(t,e){var n,s,a;const i=e.lengthOfTime||{};let r,o,l;if(i.months||i.days)if(i.months){const n=(i.startDate?d(t,i.startDate):e.startWithMonth?d(t,e.startWithMonth):t.now()).startOf("month");o=n,l=n.plus({months:i.months}).minus({days:1}).endOf("day"),r=n}else{const s=(i.startDate?d(t,i.startDate):t.now()).startOf("day").startOf("week"),a=null!==(n=e.weekOffset)&&void 0!==n?n:0;o=t.setWeekday(s,a),l=o.plus({days:i.days-1}).endOf("day"),r=o}else r=t.now().startOf("month"),o=r,l=r.endOf("month");if(e.startWithMonth){r=d(t,e.startWithMonth).startOf("month"),o=r;const n=!!(null===(s=e.lengthOfTime)||void 0===s?void 0:s.days),i=!!(null===(a=e.lengthOfTime)||void 0===a?void 0:a.months);l=n?r.plus({days:e.lengthOfTime.days-1}).endOf("day"):i?r.plus({months:e.lengthOfTime.months}).minus({days:1}).endOf("day"):r.endOf("month")}return{month:r,intervalStart:o,intervalEnd:l,selectedDate:e.selectedDate?d(t,e.selectedDate):null}}const c="\n<div class='clndr-controls'>\n  <div class='clndr-control-button'>\n    <span class='clndr-previous-button'>previous</span>\n  </div>\n  <div class='month'><%= month %> <%= year %></div>\n  <div class='clndr-control-button rightalign'>\n    <span class='clndr-next-button'>next</span>\n  </div>\n</div>\n<table class='clndr-table' border='0' cellspacing='0' cellpadding='0'>\n  <thead>\n    <tr class='header-days'>\n      <% for(var i = 0; i < daysOfTheWeek.length; i++) { %>\n        <td class='header-day'><%= daysOfTheWeek[i] %></td>\n      <% } %>\n    </tr>\n  </thead>\n  <tbody>\n    <% for(var i = 0; i < numberOfRows; i++){ %>\n      <tr>\n        <% for(var j = 0; j < 7; j++){ %>\n          <% var d = j + i * 7; %>\n          <td class='<%= days[d].classes %>'>\n            <div class='day-contents'><%= days[d].day %></div>\n          </td>\n        <% } %>\n      </tr>\n    <% } %>\n  </tbody>\n</table>\n".trim();function v(t){const e=/<%=\s*([\w.]+)\s*%>/g;return n=>t.replace(e,(t,e)=>{const s=String(e).split(".");let a=n;for(const t of s)a=null==a?void 0:a[t];return null==a?"":String(a)})}function p(t,e){return{daysOfTheWeek:e.daysOfTheWeek||t.weekdayLabels("short"),extras:e.extras,days:[],month:null,year:null,eventsThisMonth:[],eventsLastMonth:[],eventsNextMonth:[],months:[],numberOfRows:0,intervalStart:null,intervalEnd:null,eventsThisInterval:null}}function f(t){if("function"==typeof t.render)return t.render;if("string"==typeof t.template){const e=null===globalThis||void 0===globalThis?void 0:globalThis._;return e&&"function"==typeof e.template?e.template(t.template):v(t.template)}const e=null===globalThis||void 0===globalThis?void 0:globalThis._;return e&&"function"==typeof e.template?e.template(c):v(c)}const m="YYYY-MM-DD";class y{constructor(t,e){this.events=[],this.eventsThisInterval=[],this.eventsLastMonth=[],this.eventsNextMonth=[],this.constraintState={next:!0,previous:!0,nextYear:!0,previousYear:!0,today:!0},this.constraintStart=null,this.constraintEnd=null,this.currentIntervalStart=null,this.adapter=t,this.options=function(t){t.lengthOfTime?null==t.lengthOfTime.interval&&(t.lengthOfTime.interval=1):t.lengthOfTime={days:null,months:null,interval:1};return t}(e),this.state=u(t,this.options),this.bootstrapConstraints(),this.setEvents(this.options.events||[])}getOptions(){return this.options}getState(){return this.state}getConstraints(){return this.updateConstraintState(),this.constraintState}usesDaysInterval(){var t;return Boolean(null===(t=this.options.lengthOfTime)||void 0===t?void 0:t.days)}usesMonthsInterval(){var t;return Boolean(null===(t=this.options.lengthOfTime)||void 0===t?void 0:t.months)}setExtras(t){this.options.extras=t}setEvents(t){const e=this.options.multiDayEvents?this.addMultiDayDateObjects(t):this.addDateObjects(t);this.events=e,this.options.events=e}addEvents(t){const e=this.options.multiDayEvents?this.addMultiDayDateObjects(t):this.addDateObjects(t);this.events=[...this.events,...e],this.options.events=this.events}removeEvents(t){this.events=this.events.filter(e=>!t(e)),this.options.events=this.events}setSelectedDate(t){this.options.selectedDate=t?"string"!=typeof t?t.format?t.format(m):t.toISO():t:null}forward(t){var e,n;if(this.updateConstraintState(),!this.constraintState.next)return null;const s=null!==(n=null!=t?t:null===(e=this.options.lengthOfTime)||void 0===e?void 0:e.interval)&&void 0!==n?n:1;return this.updateState(t=>{var e,n;if(this.usesDaysInterval()){const n=t.intervalStart.plus({days:s}).startOf("day"),a=((null===(e=this.options.lengthOfTime)||void 0===e?void 0:e.days)||1)-1,i=n.plus({days:a}).endOf("day");return{...t,month:n,intervalStart:n,intervalEnd:i}}const a=t.intervalStart.plus({months:s}).startOf("month"),i=(null===(n=this.options.lengthOfTime)||void 0===n?void 0:n.months)||s,r=a.plus({months:i}).minus({days:1}).endOf("month");return{...t,month:a,intervalStart:a,intervalEnd:r}})}back(t){var e,n;if(this.updateConstraintState(),!this.constraintState.previous)return null;const s=null!==(n=null!=t?t:null===(e=this.options.lengthOfTime)||void 0===e?void 0:e.interval)&&void 0!==n?n:1;return this.updateState(t=>{var e,n;if(this.usesDaysInterval()){const n=t.intervalStart.minus({days:s}).startOf("day"),a=((null===(e=this.options.lengthOfTime)||void 0===e?void 0:e.days)||1)-1,i=n.plus({days:a}).endOf("day");return{...t,month:n,intervalStart:n,intervalEnd:i}}const a=t.intervalStart.minus({months:s}).startOf("month"),i=(null===(n=this.options.lengthOfTime)||void 0===n?void 0:n.months)||s,r=a.plus({months:i}).minus({days:1}).endOf("month");return{...t,month:a,intervalStart:a,intervalEnd:r}})}nextYear(){return this.updateConstraintState(),this.constraintState.nextYear?this.updateState(t=>{const e=t.intervalStart.plus({years:1}),n=t.intervalEnd.plus({years:1}),s=t.month.plus({years:1});return{...t,month:s,intervalStart:e,intervalEnd:n}}):null}previousYear(){return this.updateConstraintState(),this.constraintState.previousYear?this.updateState(t=>{const e=t.intervalStart.minus({years:1}),n=t.intervalEnd.minus({years:1}),s=t.month.minus({years:1});return{...t,month:s,intervalStart:e,intervalEnd:n}}):null}today(){return this.updateState(t=>{var e,n,s;const a=this.adapter.now();if(this.usesDaysInterval()){const n=this.options.lengthOfTime||{};let s;if(n.startDate){const t=this.parseDateInput(n.startDate),e=this.weekdayIndex(t),i=a.startOf("week");s=this.adapter.setWeekday(i,e)}else{const t=null!==(e=this.options.weekOffset)&&void 0!==e?e:0,n=a.startOf("week");s=this.adapter.setWeekday(n,t)}const i=(n.days||1)-1,r=s.plus({days:i}).endOf("day");return{...t,month:s,intervalStart:s,intervalEnd:r}}const i=a.startOf("month"),r=(null===(n=this.options.lengthOfTime)||void 0===n?void 0:n.months)||(null===(s=this.options.lengthOfTime)||void 0===s?void 0:s.interval)||1,o=i.plus({months:r}).minus({days:1}).endOf("month");return{...t,month:i,intervalStart:i,intervalEnd:o}})}setMonth(t){return this.usesDaysInterval()||this.usesMonthsInterval()?(console.warn("CLNDR: setMonth is only supported for single-month calendars."),null):this.updateState(e=>{const n=Number(e.month.format("YYYY")),s=this.resolveMonthDate(t,n).startOf("month"),a=s.endOf("month");return{...e,month:s,intervalStart:s,intervalEnd:a}})}setYear(t){return this.updateState(e=>{const n=Number(e.month.format("M"))-1,s=`${t}-${O(n+1)}-01`,a=this.adapter.fromISO(s).startOf("month"),i=a.endOf("month");return{...e,month:a,intervalStart:a,intervalEnd:i}})}setIntervalStart(t){var e,n;if(!(null===(e=this.options.lengthOfTime)||void 0===e?void 0:e.days)&&!(null===(n=this.options.lengthOfTime)||void 0===n?void 0:n.months))return console.warn("CLNDR: setIntervalStart is only available when using lengthOfTime."),null;const s=this.parseDateInput(t);return this.updateState(t=>{var e,n,a;if(this.usesDaysInterval()){const n=s.startOf("day"),a=((null===(e=this.options.lengthOfTime)||void 0===e?void 0:e.days)||1)-1,i=n.plus({days:a}).endOf("day");return{...t,month:n,intervalStart:n,intervalEnd:i}}const i=s.startOf("month"),r=(null===(n=this.options.lengthOfTime)||void 0===n?void 0:n.months)||(null===(a=this.options.lengthOfTime)||void 0===a?void 0:a.interval)||1,o=i.plus({months:r}).minus({days:1}).endOf("month");return{...t,month:i,intervalStart:i,intervalEnd:o}})}buildTemplateData(){var t;const e={...p(this.adapter,this.options)};if(this.usesDaysInterval()){const t=this.createDaysObject(this.state.intervalStart,this.state.intervalEnd);e.days=t,e.month=null,e.year=null,e.intervalStart=this.state.intervalStart.value(),e.intervalEnd=this.state.intervalEnd.value(),e.numberOfRows=Math.ceil(t.length/7),e.eventsThisInterval=this.eventsThisInterval,e.eventsLastMonth=[],e.eventsNextMonth=[]}else if(this.usesMonthsInterval()){const n=[],s=[];let a=0;const i=(null===(t=this.options.lengthOfTime)||void 0===t?void 0:t.months)||0;for(let t=0;t<i;t++){const e=this.state.intervalStart.plus({months:t}).startOf("month"),i=e.endOf("month"),r=this.createDaysObject(e,i);n.push({days:r,month:e.value()}),s.push([...this.eventsThisInterval]),a+=Math.ceil(r.length/7)}e.days=[],e.months=n,e.numberOfRows=a,e.eventsThisInterval=s,e.intervalStart=this.state.intervalStart.value(),e.intervalEnd=this.state.intervalEnd.value()}else{const t=this.state.month.startOf("month"),n=t.endOf("month"),s=this.createDaysObject(t,n);e.days=s,e.month=this.state.month.format?this.state.month.format("MMMM"):"",e.year=this.state.month.format?this.state.month.format("YYYY"):"",e.eventsThisMonth=this.eventsThisInterval,e.numberOfRows=Math.ceil(s.length/7),e.eventsLastMonth=this.eventsLastMonth,e.eventsNextMonth=this.eventsNextMonth}return e}updateState(t){const e={...this.state};return this.state=t(this.state),this.updateConstraintState(),{previous:e,current:this.state}}parseDateInput(t){if(!t)return this.adapter.now();if("string"==typeof t)return this.adapter.fromISO(t);if("number"==typeof t)return this.adapter.fromNative(new Date(t));if("object"==typeof t){if(t.value&&"function"==typeof t.value)return this.adapter.fromNative(t.value());if("function"==typeof t.toISOString)return this.adapter.fromISO(t.toISOString())}return this.adapter.fromNative(t)}addDateObjects(t){const e=this.options.dateParameter||"date";return t.map(t=>{const n=this.parseDateInput(t[e]),s=t;return s._clndrStartDateObject=n,s._clndrEndDateObject=n,s})}addMultiDayDateObjects(t){const e=this.options.multiDayEvents;return t.map(t=>{var n,s;const a=t,i=null!==(n=t[e.startDate])&&void 0!==n?n:e.singleDay?t[e.singleDay]:null,r=null!==(s=t[e.endDate])&&void 0!==s?s:e.singleDay?t[e.singleDay]:null,o=this.parseDateInput(i||r),l=this.parseDateInput(r||i);return a._clndrStartDateObject=o,a._clndrEndDateObject=l,a})}eventsInRange(t,e,n){const s=e.startOf("day"),a=n.endOf("day");return t.filter(t=>{const e=t._clndrEndDateObject.isBefore(s),n=t._clndrStartDateObject.isAfter(a);return!(e||n)})}createDaysObject(t,e){var n,s,a,i;const r=[],o=t.startOf("day"),l=e.endOf("day");if(this.currentIntervalStart=o,this.eventsThisInterval=this.eventsInRange(this.events,o,l),!this.usesDaysInterval()&&this.options.showAdjacentMonths){const t=o.startOf("month"),e=t.minus({months:1}),n=e.endOf("month"),s=t.plus({months:1}),a=s.endOf("month");this.eventsLastMonth=this.eventsInRange(this.events,e,n),this.eventsNextMonth=this.eventsInRange(this.events,s,a)}else this.eventsLastMonth=[],this.eventsNextMonth=[];if(!this.usesDaysInterval()){const t=null!==(n=this.options.weekOffset)&&void 0!==n?n:0;let e=this.weekdayIndex(o)-t;if(e<0&&(e+=7),this.options.showAdjacentMonths)for(let t=e;t>0;t--){const e=o.minus({days:t});r.push(this.createDayObject(e,this.eventsLastMonth))}else for(let t=0;t<e;t++)r.push(this.calendarDay({classes:`${this.targetsEmpty()} ${(null===(s=this.options.classes)||void 0===s?void 0:s.lastMonth)||""}`.trim()}))}let h=o;for(;!h.isAfter(l);)r.push(this.createDayObject(h,this.eventsThisInterval)),h=h.plus({days:1});if(!this.usesDaysInterval())for(;r.length%7!=0;)this.options.showAdjacentMonths?r.push(this.createDayObject(h,this.eventsNextMonth)):r.push(this.calendarDay({classes:`${this.targetsEmpty()} ${(null===(a=this.options.classes)||void 0===a?void 0:a.nextMonth)||""}`.trim()})),h=h.plus({days:1});if(this.options.forceSixRows&&r.length<42)for(;r.length<42;)this.options.showAdjacentMonths?r.push(this.createDayObject(h,this.eventsNextMonth)):r.push(this.calendarDay({classes:`${this.targetsEmpty()} ${(null===(i=this.options.classes)||void 0===i?void 0:i.nextMonth)||""}`.trim()})),h=h.plus({days:1});return r}createDayObject(t,e){var n,s,a,i,r,o,l,h,d,u;const c=t.startOf("day"),v=t.endOf("day"),p=e.filter(t=>{const e=t._clndrEndDateObject.isBefore(c),n=t._clndrStartDateObject.isAfter(v);return!(e||n)}),f=[this.targetsDay()],y={isToday:!1,isInactive:!1,isAdjacentMonth:!1},O=this.adapter.now();t.hasSame(O,"day")&&(f.push((null===(n=this.options.classes)||void 0===n?void 0:n.today)||"today"),y.isToday=!0);const g=O.startOf("day");if(v.isBefore(g)&&f.push((null===(s=this.options.classes)||void 0===s?void 0:s.past)||"past"),p.length&&f.push((null===(a=this.options.classes)||void 0===a?void 0:a.event)||"event"),!this.usesDaysInterval()&&this.currentIntervalStart){const e=this.currentIntervalStart.startOf("month"),n=e.endOf("month");t.isBefore(e)?(f.push((null===(i=this.options.classes)||void 0===i?void 0:i.adjacentMonth)||"adjacent-month"),f.push((null===(r=this.options.classes)||void 0===r?void 0:r.lastMonth)||"last-month"),y.isAdjacentMonth=!0):t.isAfter(n)&&(f.push((null===(o=this.options.classes)||void 0===o?void 0:o.adjacentMonth)||"adjacent-month"),f.push((null===(l=this.options.classes)||void 0===l?void 0:l.nextMonth)||"next-month"),y.isAdjacentMonth=!0)}if(this.constraintStart&&t.isBefore(this.constraintStart)&&(f.push((null===(h=this.options.classes)||void 0===h?void 0:h.inactive)||"inactive"),y.isInactive=!0),this.constraintEnd&&t.isAfter(this.constraintEnd)&&(f.push((null===(d=this.options.classes)||void 0===d?void 0:d.inactive)||"inactive"),y.isInactive=!0),this.options.selectedDate){const e=this.parseDateInput(this.options.selectedDate);t.hasSame(e,"day")&&f.push((null===(u=this.options.classes)||void 0===u?void 0:u.selected)||"selected")}return f.push(`calendar-day-${t.format(m)}`),f.push(`calendar-dow-${this.weekdayIndex(t)}`),this.calendarDay({date:t.value(),day:t.day(),events:p,properties:y,classes:f.join(" ").trim()})}calendarDay(t){var e,n,s,a;return{day:null!==(e=t.day)&&void 0!==e?e:0,date:null!==(n=t.date)&&void 0!==n?n:null,events:null!==(s=t.events)&&void 0!==s?s:[],classes:null!==(a=t.classes)&&void 0!==a?a:this.targetsEmpty(),properties:t.properties}}targetsDay(){var t;return(null===(t=this.options.targets)||void 0===t?void 0:t.day)||"day"}targetsEmpty(){var t;return(null===(t=this.options.targets)||void 0===t?void 0:t.empty)||"empty"}weekdayIndex(t){let e=t.weekday()%7-this.adapter.firstDayOfWeek();return e<0&&(e+=7),e}bootstrapConstraints(){this.options.constraints&&(this.options.constraints.startDate&&(this.constraintStart=this.parseDateInput(this.options.constraints.startDate).startOf("day")),this.options.constraints.endDate&&(this.constraintEnd=this.parseDateInput(this.options.constraints.endDate).endOf("day")),this.updateConstraintState())}updateConstraintState(){const t={next:!0,previous:!0,nextYear:!0,previousYear:!0,today:!0};if(!this.constraintStart&&!this.constraintEnd)return void(this.constraintState=t);const e=this.constraintStart,n=this.constraintEnd,s=this.state.intervalStart.minus({years:1}),a=this.state.intervalEnd.plus({years:1});if(e){(e.isAfter(this.state.intervalStart)||(this.usesDaysInterval()?e.hasSame(this.state.intervalStart,"day"):e.hasSame(this.state.intervalStart,"month")))&&(t.previous=!1),e.isAfter(s)&&(t.previousYear=!1)}if(n){(n.isBefore(this.state.intervalEnd)||(this.usesDaysInterval()?n.hasSame(this.state.intervalEnd,"day"):n.hasSame(this.state.intervalEnd,"month")))&&(t.next=!1),n.isBefore(a)&&(t.nextYear=!1)}const i=this.adapter.now().startOf("month");(e&&e.isAfter(i)||n&&n.isBefore(i))&&(t.today=!1),this.constraintState=t}resolveMonthDate(t,e){if("number"==typeof t){const n=`${e}-${O(t+1)}-01`;return this.adapter.fromISO(n)}const n=["MMMM YYYY","MMM YYYY"];for(const s of n)try{return this.adapter.fromFormat(`${t} ${e}`,s)}catch(t){}return this.adapter.fromISO(`${e}-01-01`)}}function O(t){return t<10?`0${t}`:String(t)}class g{constructor(t,e,n,s){this.apiContext=null,this.core=e,this.renderer=n,this.adapter=s,this.options=e.getOptions(),this.element=this.resolveElement(t),this.assertSingleElement(this.element),this.element.html("<div class='clndr'></div>"),this.container=this.element.find(".clndr"),this.eventType=this.options.useTouchEvents?"touchstart":"click",this.eventName=`${this.eventType}.clndr`,this.bindEvents()}attachApi(t){this.apiContext=t}render(){var t;const e=this.core.buildTemplateData(),n=this.renderer(e);this.container.html(n),this.applyConstraintClasses(),"function"==typeof this.options.doneRendering&&this.options.doneRendering.apply(null!==(t=this.apiContext)&&void 0!==t?t:this,[])}applyChange(t,e={}){var n,s;this.render();const a=!1!==e.fireCallbacks;"today"===e.action&&a&&(null===(n=this.options.clickEvents)||void 0===n?void 0:n.today)&&this.options.clickEvents.today.apply(null!==(s=this.apiContext)&&void 0!==s?s:this,[t.current.month.value()]),a&&this.triggerEvents(t)}destroy(){this.element.off(".clndr"),this.container.remove()}bindEvents(){const t=this.options.targets,e=this.eventName;this.element.off(".clndr"),this.element.on(e,`.${t.day}`,t=>this.handleDayClick(t)),this.element.on(e,`.${t.empty}`,t=>this.handleEmptyClick(t)),this.element.on(e,`.${t.nextButton}`,t=>{t.preventDefault(),this.handleNavigation("forward")}),this.element.on(e,`.${t.previousButton}`,t=>{t.preventDefault(),this.handleNavigation("back")}),this.element.on(e,`.${t.nextYearButton}`,t=>{t.preventDefault(),this.handleNavigation("nextYear")}),this.element.on(e,`.${t.previousYearButton}`,t=>{t.preventDefault(),this.handleNavigation("previousYear")}),this.element.on(e,`.${t.todayButton}`,t=>{t.preventDefault(),this.handleNavigation("today")})}handleDayClick(t){var e,n,a,i,r;const o=this.resolveEventElement(t,`.${(null===(e=this.options.targets)||void 0===e?void 0:e.day)||"day"}`);if(!o)return;const l=s(o),h=this.handleAdjacentDay(l);if(this.options.trackSelectedDate&&!0!==h){const t=(null===(n=this.options.classes)||void 0===n?void 0:n.inactive)||"inactive",e=(null===(a=this.options.classes)||void 0===a?void 0:a.selected)||"selected",s=e.split(/\s+/).filter(Boolean),i=l.hasClass(t),r=!0===this.options.ignoreInactiveDaysInSelection;if(!i||!r){const t=this.getTargetDateString(o);if(t){this.core.setSelectedDate(t);for(const t of s)this.container.find(`.${t}`).removeClass(t),t&&o.classList.remove(t);this.highlightSelectedDay(t,e,s),l.addClass(e),o.className=`${o.className} ${e}`.trim()}}}if(null===(i=this.options.clickEvents)||void 0===i?void 0:i.click){const t=this.buildTargetObject(o,!0);this.options.clickEvents.click.apply(null!==(r=this.apiContext)&&void 0!==r?r:this,[t])}}handleEmptyClick(t){var e,n,a;const i=this.resolveEventElement(t,`.${(null===(e=this.options.targets)||void 0===e?void 0:e.empty)||"empty"}`);if(!i)return;const r=s(i);if(this.handleAdjacentDay(r),null===(n=this.options.clickEvents)||void 0===n?void 0:n.click){const t=this.buildTargetObject(i,!1);this.options.clickEvents.click.apply(null!==(a=this.apiContext)&&void 0!==a?a:this,[t])}}handleNavigation(t){let e=null;switch(t){case"forward":e=this.core.forward();break;case"back":e=this.core.back();break;case"nextYear":e=this.core.nextYear();break;case"previousYear":e=this.core.previousYear();break;case"today":e=this.core.today()}e&&this.applyChange(e,{action:"today"===t?"today":void 0,fireCallbacks:!0})}triggerEvents(t){var e,n,s,a,i,r,o,l,h;const d=this.options.clickEvents;if(!d)return;const u=t.previous,c=t.current,v=c.intervalStart,p=u.intervalStart;c.intervalEnd,u.intervalEnd;const f=[c.month.value()],m=[c.intervalStart.value(),c.intervalEnd.value()],y=v.isAfter(p),O=v.isBefore(p),g=y||O,D=!c.intervalStart.hasSame(u.intervalStart,"month"),w=!c.intervalStart.hasSame(u.intervalStart,"year"),S=this.options.lengthOfTime||{};S.days||S.months?(y&&d.nextInterval&&d.nextInterval.apply(null!==(e=this.apiContext)&&void 0!==e?e:this,m),O&&d.previousInterval&&d.previousInterval.apply(null!==(n=this.apiContext)&&void 0!==n?n:this,m),g&&d.onIntervalChange&&d.onIntervalChange.apply(null!==(s=this.apiContext)&&void 0!==s?s:this,m)):(D&&v.isAfter(p)&&d.nextMonth&&d.nextMonth.apply(null!==(a=this.apiContext)&&void 0!==a?a:this,f),D&&v.isBefore(p)&&d.previousMonth&&d.previousMonth.apply(null!==(i=this.apiContext)&&void 0!==i?i:this,f),D&&d.onMonthChange&&d.onMonthChange.apply(null!==(r=this.apiContext)&&void 0!==r?r:this,f),w&&v.isAfter(p)&&d.nextYear&&d.nextYear.apply(null!==(o=this.apiContext)&&void 0!==o?o:this,f),w&&v.isBefore(p)&&d.previousYear&&d.previousYear.apply(null!==(l=this.apiContext)&&void 0!==l?l:this,f),w&&d.onYearChange&&d.onYearChange.apply(null!==(h=this.apiContext)&&void 0!==h?h:this,f))}buildTargetObject(t,e){const n={element:t,date:null,events:[]};if(!e)return n;const s=this.getTargetDateString(t);if(!s)return n;const a=this.adapter.fromISO(s);return n.date=a.value(),n.events=this.findEventsForDate(a),n}findEventsForDate(t){const e=this.options.events||[],n=t.startOf("day"),s=t.endOf("day");return e.filter(t=>{const e=t._clndrStartDateObject,a=t._clndrEndDateObject;if(!e||!a)return!1;const i=a.isBefore(n),r=e.isAfter(s);return!(i||r)})}getTargetDateString(t){const e=t.className||"",n=e.indexOf("calendar-day-");return-1===n?null:e.substr(n+13,10)}handleAdjacentDay(t){if(!this.options.adjacentDaysChangeMonth)return!1;const e=this.options.classes||{};if(t.hasClass(e.lastMonth||"last-month")){const t=this.core.back();return t&&this.applyChange(t,{fireCallbacks:!0}),!0}if(t.hasClass(e.nextMonth||"next-month")){const t=this.core.forward();return t&&this.applyChange(t,{fireCallbacks:!0}),!0}return!1}applyConstraintClasses(){var t;const e=this.core.getConstraints(),n=(null===(t=this.options.classes)||void 0===t?void 0:t.inactive)||"inactive",s=this.options.targets,a=[["previous",s.previousButton],["next",s.nextButton],["previousYear",s.previousYearButton],["nextYear",s.nextYearButton],["today",s.todayButton]];for(const[t,s]of a)s&&this.element.find(`.${s}`).toggleClass(n,!e[t])}resolveElement(t){return"string"==typeof t?s(t):t.jquery?t:s(t)}assertSingleElement(t){if(0===t.length)throw new Error("CLNDR: No element found for selector.");if(t.length>1)throw new Error("CLNDR: Multiple elements are not supported per instance.")}resolveEventElement(t,e){const n=t.currentTarget;if(n&&n.matches(e))return n;const s=t.target;if(s){const t=s.closest(e);if(t)return t}return null}highlightSelectedDay(t,e,n){const s=this.container.find(`.calendar-day-${t}`).first();if(!s.length)return;s.addClass(e);const a=s.get(0);if(a)for(const t of n)t&&a.classList.add(t)}}function D(t,e){const n=(e%t.length+t.length)%t.length;return[...t.slice(n),...t.slice(0,n)]}const w={day:"day",empty:"empty",nextButton:"clndr-next-button",todayButton:"clndr-today-button",previousButton:"clndr-previous-button",nextYearButton:"clndr-next-year-button",previousYearButton:"clndr-previous-year-button"},S={past:"past",today:"today",event:"event",inactive:"inactive",selected:"selected",lastMonth:"last-month",nextMonth:"next-month",adjacentMonth:"adjacent-month"};function k(t,e={}){var n,s,a,i,r,o,l,h,d;const u={weekOffset:null!==(n=e.weekOffset)&&void 0!==n?n:0,showAdjacentMonths:null===(s=e.showAdjacentMonths)||void 0===s||s,trackSelectedDate:null!==(a=e.trackSelectedDate)&&void 0!==a&&a,dateParameter:"date",template:e.template,render:e.render,startWithMonth:e.startWithMonth,daysOfTheWeek:e.daysOfTheWeek,formatWeekdayHeader:e.formatWeekdayHeader,targets:{...w,...e.targets||{}},classes:{...S,...e.classes||{}},clickEvents:e.clickEvents,useTouchEvents:e.useTouchEvents,ready:e.ready,doneRendering:e.doneRendering,events:e.events||[],multiDayEvents:e.multiDayEvents,adjacentDaysChangeMonth:null!==(i=e.adjacentDaysChangeMonth)&&void 0!==i&&i,forceSixRows:null!==(r=e.forceSixRows)&&void 0!==r?r:null,selectedDate:null!==(o=e.selectedDate)&&void 0!==o?o:null,ignoreInactiveDaysInSelection:null!==(l=e.ignoreInactiveDaysInSelection)&&void 0!==l?l:null,lengthOfTime:e.lengthOfTime,extras:e.extras,constraints:null!==(h=e.constraints)&&void 0!==h?h:null,moment:null!==(d=e.moment)&&void 0!==d?d:null},c=function(t,e){var n;const s=null!==(n=e.weekOffset)&&void 0!==n?n:0;if(e.daysOfTheWeek&&7===e.daysOfTheWeek.length)return D(e.daysOfTheWeek,s);if("function"==typeof e.formatWeekdayHeader){const n=t.now().startOf("week");return Array.from({length:7},(a,i)=>{const r=(i+s)%7,o=t.setWeekday(n,r);return e.formatWeekdayHeader(o.value())})}const a=t.now().startOf("week");return D(Array.from({length:7},(e,n)=>(t.setWeekday(a,n).format("dd")||"").charAt(0)),s)}(t,u);return{options:u,daysOfTheWeek:c}}function b(t,e={}){const n=function(t){var e;if(t.dateAdapter)return t.dateAdapter;const n="undefined"!=typeof process&&(null===(e=process.env)||void 0===e?void 0:e.DATE_LIB)?process.env.DATE_LIB:null;if("luxon"===(t.dateLibrary||n||"moment"))return r(t.locale,t.zone);return h(t.locale)}(e),s=k(n,e);s.options.daysOfTheWeek=s.options.daysOfTheWeek||s.daysOfTheWeek;const a=new y(n,s.options),i=f(s.options),o=new g(t,a,i,n),l=function(t,e){const n=t.getOptions(),s=(t,n={})=>{t&&e.applyChange(t,{action:n.action,fireCallbacks:!0===n.withCallbacks})},a={options:n,element:e.element[0],render(){return e.render(),this},forward(e){return s(t.forward(),{withCallbacks:null==e?void 0:e.withCallbacks}),this},next(t){return this.forward(t)},back(e){return s(t.back(),{withCallbacks:null==e?void 0:e.withCallbacks}),this},previous(t){return this.back(t)},nextYear(e){return s(t.nextYear(),{withCallbacks:null==e?void 0:e.withCallbacks}),this},previousYear(e){return s(t.previousYear(),{withCallbacks:null==e?void 0:e.withCallbacks}),this},today(e){s(t.today(),{action:"today",withCallbacks:null==e?void 0:e.withCallbacks})},setMonth(e,n){return s(t.setMonth(e),{withCallbacks:null==n?void 0:n.withCallbacks}),this},setYear(e,n){return s(t.setYear(e),{withCallbacks:null==n?void 0:n.withCallbacks}),this},setExtras(n){return t.setExtras(n),e.render(),this},setEvents(n){return t.setEvents(n),e.render(),this},addEvents(n,s=!0){return t.addEvents(n),!1!==s&&e.render(),this},removeEvents(n){return t.removeEvents(n),e.render(),this},destroy(){e.destroy()}};return a}(a,o);return o.attachApi(l),o.render(),"function"==typeof s.options.ready&&s.options.ready.apply(l,[]),l}function M(){s.fn&&(s.fn.clndr=function(t){if(0===this.length)throw new Error("CLNDR: No element selected for jQuery plugin.");if(this.length>1)throw new Error("CLNDR: Please initialize one calendar per jQuery collection.");return b(this[0],t)})}"undefined"!=typeof window&&window.jQuery&&M(),t.ClndrCore=y,t.ClndrDOM=g,t.DEFAULT_TEMPLATE=c,t.LuxonDateAdapter=i,t.MomentDateAdapter=l,t.baseTemplateData=p,t.clndr=b,t.compile=v,t.createLuxonAdapter=r,t.createMomentAdapter=h,t.createRenderer=f,t.initState=u,t.normalizeOptions=k,t.registerJQueryPlugin=M,t.renderWithTemplate=function(t,e){return{html:t(e)}},t.rotate=D});
//# sourceMappingURL=clndr.min.js.map
